# 打印功能

## 打印功能简介

苍穹打印功能通常在业务过程中存在数据打印需求，如打印凭证、采购单、出入库单据等等。单据数据不同打印的模板也是千变万化，打印模板的设计器是可设计出符合业务的打印模板，完全符合业务需求自定义定制，用户可通过拖拉拽及配置的方式完成打印模板的设计。无论是打印纸张规格、打印方向，还是打印样式，都可以自由调整设计，轻松实现数据套打。

## 打印功能详细

https://developer.kingdee.com/knowledge/specialDetail/164785655732573952?category=-1&id=499153913879430400&productLineId=29&lang=zh-CN

## 借书单据打印

![1-效果图](.\picture\1-效果图.png)

### 创建打印模板

在首页左上方，打开应用按钮，输入**维护打印模板**，进入打印模板界面

![3-打印模板地址](.\picture\3-打印模板地址.png)

在页面中点击新增，新增打印模板

![4-新增打印模板](.\picture\4-新增打印模板.png)

选择实体和模板，在本次的案例中，选择**书籍借阅**表单

![5-选择实体和模板](.\picture\5-选择实体和模板.png)

### 制作打印模板

选择**横向布局**，本次我们利用横向布局来制作打印模板。

![6-选择横向](.\picture\6-选择横向.png)

设计布局网络，本次我们设置**7列4行**

![7-设计布局网格](.\picture\7-设计布局网格.png)

合并单元格，将要制作的结构和轮廓表示出来

![8-合并单元格](.\picture\8-合并单元格.png)

添加**图片字段**到第一个合并的单元格

![9-添加图片选择字段](.\picture\9-添加图片选择字段.png)

在字段选择中，选择书籍图片

![10-书籍图片](.\picture\10-书籍图片.png)

填写单元格，直接输入文字即可

![11-填写单元格](.\picture\11-填写单元格.png)

添加字段显示，选择**单据编号**

![12-选择单据编号](.\picture\12-选择单据编号.png)

添加完成后，选中单元格，可在上方的属性栏中设置属性

![13-设置属性](.\picture\13-设置属性.png)

按此方法设计完成剩下的单元格，并按实际需求调整单元格，如把第一列第三行的单元格合并了

![14-设计完成](.\picture\14-设计完成.png)

表格设置完成之后，我们需要设置下方的空格。点击左上方的文字，添加一个单独的文本

![15-添加一个单独文本](.\picture\15-添加一个单独文本.png)

设置文字公式，公式为

**<u>"用户 " +借阅人.姓名+ " 在 "+借阅日期+" 借阅了书籍 "+书籍名称+" ，借阅天数为 "+借阅天数+" ，归还日期为 "+归还日期+"。"</u>**

![16-设置文字公式](.\picture\16-设置文字公式.png)

同样，新增剩下的组件

![16-新增更多](.\picture\16-新增更多.png)

经过同样的编辑之后，得到以下的结果

![17-编辑图](.\picture\17-编辑图.png)

### 设置打印模板

进入书籍借阅列表页面预览，进入打印设置

![18-设置打印模板](.\picture\18-设置打印模板.png)

默认模板选择刚刚设置的**书籍借阅记录**

![19-打印设置](.\picture\19-打印设置.png)

最后打印数据，则打印成功

![20-打印数据](.\picture\20-打印数据.png)
